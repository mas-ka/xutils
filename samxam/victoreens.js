elements = [
    {"Name":  "-", "ZoA": -1.000, "A": [-1.000000, -1.000000, -1.000000, -1.000000], "C": [0,  -1.00,  -1.00,  -1.00,  -1.00,  -1.00], "D": [0,      -1.00,     -1.00,  -1.00,  -1.00,  -1.00]},
    {"Name":  "H", "ZoA": 0.9921, "A": [ 911.6490, -1.000000, -1.000000, -1.000000], "C": [0, 0.0127,  -1.00,  -1.00,  -1.00,  -1.00], "D": [0, 0.00000466,     -1.00,  -1.00,  -1.00,  -1.00]},
    {"Name": "He", "ZoA": 0.4996, "A": [ 504.0011, -1.000000, -1.000000, -1.000000], "C": [0, 0.0514,  -1.00,  -1.00,  -1.00,  -1.00], "D": [0,  0.0000752,     -1.00,  -1.00,  -1.00,  -1.00]},
    {"Name": "Li", "ZoA": 0.4323, "A": [ 226.6623, -1.000000, -1.000000, -1.000000], "C": [0,  0.150,  -1.00,  -1.00,  -1.00,  -1.00], "D": [0,   0.000494,     -1.00,  -1.00,  -1.00,  -1.00]},
    {"Name": "Be", "ZoA": 0.4438, "A": [ 111.1967, -1.000000, -1.000000, -1.000000], "C": [0,  0.365,  -1.00,  -1.00,  -1.00,  -1.00], "D": [0,    0.00213,     -1.00,  -1.00,  -1.00,  -1.00]},
    {"Name":  "B", "ZoA": 0.4621, "A": [ 65.94908, -1.000000, -1.000000, -1.000000], "C": [0,  0.609,  -1.00,  -1.00,  -1.00,  -1.00], "D": [0,    0.00451,     -1.00,  -1.00,  -1.00,  -1.00]},
    {"Name":  "C", "ZoA": 0.4995, "A": [ 43.62571, -1.000000, -1.000000, -1.000000], "C": [0,   1.22,  -1.00,  -1.00,  -1.00,  -1.00], "D": [0,     0.0142,     -1.00,  -1.00,  -1.00,  -1.00]},
    {"Name":  "N", "ZoA": 0.4997, "A": [ 30.24744, -1.000000, -1.000000, -1.000000], "C": [0,   2.05,  -1.00,  -1.00,  -1.00,  -1.00], "D": [0,     0.0317,     -1.00,  -1.00,  -1.00,  -1.00]},
    {"Name":  "O", "ZoA": 0.5000, "A": [ 22.82899, -1.000000, -1.000000, -1.000000], "C": [0,   3.18,  -1.00,  -1.00,  -1.00,  -1.00], "D": [0,     0.0654,     -1.00,  -1.00,  -1.00,  -1.00]},
    {"Name":  "F", "ZoA": 0.4737, "A": [ 17.79593, -1.000000, -1.000000, -1.000000], "C": [0,   4.60,  -1.00,  -1.00,  -1.00,  -1.00], "D": [0,      0.112,     -1.00,  -1.00,  -1.00,  -1.00]},
    {"Name": "Ne", "ZoA": 0.4955, "A": [ 14.24779, -1.000000, -1.000000, -1.000000], "C": [0,   6.51,  -1.00,  -1.00,  -1.00,  -1.00], "D": [0,      0.206,     -1.00,  -1.00,  -1.00,  -1.00]},
    {"Name": "Na", "ZoA": 0.4784, "A": [ 11.57649,  195.2508,  403.8575,  402.5463], "C": [0,   8.67,  -1.00,  -1.00,  -1.00,  -1.00], "D": [0,      0.330,     -1.00,  -1.00,  -1.00,  -1.00]},
    {"Name": "Mg", "ZoA": 0.4934, "A": [ 9.515293,  139.7793,  248.9644,  250.4733], "C": [0,   11.3,  0.429,  -1.00,  -1.00,  -1.00], "D": [0,      0.539,  -0.00486,  -1.00,  -1.00,  -1.00]},
    {"Name": "Al", "ZoA": 0.4818, "A": [ 7.952807,  105.2498,  169.8415,  170.7772], "C": [0,   14.4,  0.660,  -1.00,  -1.00,  -1.00], "D": [0,      0.803, -0.000633,  -1.00,  -1.00,  -1.00]},
    {"Name": "Si", "ZoA": 0.4984, "A": [ 6.741939,  82.82182,  124.2327,  124.7327], "C": [0,   18.2,   1.50,  -1.00,  -1.00,  -1.00], "D": [0,       1.10,    0.0835,  -1.00,  -1.00,  -1.00]},
    {"Name":  "P", "ZoA": 0.4843, "A": [ 5.777459,  65.60014,  91.16490,  91.84020], "C": [0,   22.6,   1.63,  -1.00,  -1.00,  -1.00], "D": [0,       1.55,    0.0734,  -1.00,  -1.00,  -1.00]},
    {"Name":  "S", "ZoA": 0.4990, "A": [ 5.015545,  53.69609,  75.78500,  76.29801], "C": [0,   27.6,   2.12,  -1.00,  -1.00,  -1.00], "D": [0,       2.18,     0.101,  -1.00,  -1.00,  -1.00]},
    {"Name": "Cl", "ZoA": 0.4795, "A": [ 4.393489,  45.92010,  61.37835,  61.99213], "C": [0,   33.4,   2.76,  -1.00,  -1.00,  -1.00], "D": [0,       3.03,     0.180,  -1.00,  -1.00,  -1.00]},
    {"Name": "Ar", "ZoA": 0.4506, "A": [ 3.867257,  37.99702,  49.47497,  49.91315], "C": [0,   40.0,   3.47,  -1.00,  -1.00,  -1.00], "D": [0,       4.18,     0.296,  -1.00,  -1.00,  -1.00]},
    {"Name":  "K", "ZoA": 0.4859, "A": [ 3.436371,  32.74809,  41.70342,  42.08563], "C": [0,   47.4,   3.69,  -1.00,  -1.00,  -1.00], "D": [0,       5.59,     0.177,  -1.00,  -1.00,  -1.00]},
    {"Name": "Ca", "ZoA": 0.4990, "A": [ 3.069677,  28.28108,  35.45446,  35.81290], "C": [0,   55.8,   4.88,  -1.00,  -1.00,  -1.00], "D": [0,       7.56,     0.336,  -1.00,  -1.00,  -1.00]},
    {"Name": "Sc", "ZoA": 0.4671, "A": [ 2.760113,  24.89644,  30.71959,  31.09713], "C": [0,   65.2,   5.10,  -1.00,  -1.00,  -1.00], "D": [0,       9.81,     0.278,  -1.00,  -1.00,  -1.00]},
    {"Name": "Ti", "ZoA": 0.4593, "A": [ 2.496663,  22.10452,  26.94139,  27.32135], "C": [0,   75.6,   5.15,  -1.00,  -1.00,  -1.00], "D": [0,       12.3,     0.153,  -1.00,  -1.00,  -1.00]},
    {"Name":  "V", "ZoA": 0.4514, "A": [ 2.268697,  19.78367,  23.85230,  24.21095], "C": [0,   86.9,   6.14,  -1.00,  -1.00,  -1.00], "D": [0,       15.1,     0.203,  -1.00,  -1.00,  -1.00]},
    {"Name": "Cr", "ZoA": 0.4614, "A": [ 2.070200,  17.81383,  21.23746,  21.59628], "C": [0,   99.0,   7.24,  -1.00,  -1.00,  -1.00], "D": [0,       18.2,     0.268,  -1.00,  -1.00,  -1.00]},
    {"Name": "Mn", "ZoA": 0.4550, "A": [ 1.896074,  16.27090,  18.90004,  19.25221], "C": [0,    112,   8.51,  -1.00,  -1.00,  -1.00], "D": [0,       22.3,     0.344,  -1.00,  -1.00,  -1.00]},
    {"Name": "Fe", "ZoA": 0.4655, "A": [ 1.743066,  14.60356,  17.17234,  17.48720], "C": [0,    126,   9.55,  -1.00,  -1.00,  -1.00], "D": [0,       27.2,     0.433,  -1.00,  -1.00,  -1.00]},
    {"Name": "Co", "ZoA": 0.4581, "A": [ 1.608326,  13.34599,  15.53688,  15.83452], "C": [0,    141,   11.6,  -1.00,  -1.00,  -1.00], "D": [0,       33.2,     0.535,  -1.00,  -1.00,  -1.00]},
    {"Name": "Ni", "ZoA": 0.4769, "A": [ 1.487906,  12.29881,  14.13732,  14.45038], "C": [0,    158,   13.4,  -1.00,  -1.00,  -1.00], "D": [0,       40.1,     0.651,  -1.00,  -1.00,  -1.00]},
    {"Name": "Cu", "ZoA": 0.4564, "A": [ 1.380840,  11.31140,  12.99625,  13.26035], "C": [0,    176,   15.6,  -1.00,  -1.00,  -1.00], "D": [0,       48.3,     0.779,  -1.00,  -1.00,  -1.00]},
    {"Name": "Zn", "ZoA": 0.4589, "A": [ 1.283667,  10.38742,  11.88955,  12.15890], "C": [0,    195,   17.8,  -1.00,  -1.00,  -1.00], "D": [0,       57.7,     0.937,  -1.00,  -1.00,  -1.00]},
    {"Name": "Ga", "ZoA": 0.4446, "A": [ 1.195940,  9.554155,  10.85391,  11.11568], "C": [0,    216,   20.2,  -1.00,  -1.00,  -1.00], "D": [0,       68.6,      1.13,  -1.00,  -1.00,  -1.00]},
    {"Name": "Ge", "ZoA": 0.4408, "A": [ 1.116663,  8.766476,  9.936229,  10.19021], "C": [0,    238,   22.7,  -1.00,  -1.00,  -1.00], "D": [0,       81.1,      1.37,  -1.00,  -1.00,  -1.00]},
    {"Name": "As", "ZoA": 0.4405, "A": [ 1.044808,  8.122127,  9.125884,  9.370740], "C": [0,    262,   25.3,  -1.00,  -1.00,  -1.00], "D": [0,       95.4,      1.67,  -1.00,  -1.00,  -1.00]},
    {"Name": "Se", "ZoA": 0.4306, "A": [0.9795090,  7.496479,  8.398880,  8.635204], "C": [0,    287,   28.0,  -1.00,  -1.00,  -1.00], "D": [0,        112,      2.02,  -1.00,  -1.00,  -1.00]},
    {"Name": "Br", "ZoA": 0.4380, "A": [0.9199900,  6.957591,  7.768438,  7.999501], "C": [0,    314,   30.9,  -1.00,  -1.00,  -1.00], "D": [0,        130,      2.43,  -1.00,  -1.00,  -1.00]},
    {"Name": "Kr", "ZoA": 0.4296, "A": [0.8654730,  6.454152,  7.178339,  7.402488], "C": [0,    343,   33.9,  -1.00,  -1.00,  -1.00], "D": [0,        151,      2.92,  -1.00,  -1.00,  -1.00]},
    {"Name": "Rb", "ZoA": 0.4328, "A": [0.8157020,  6.003790,  6.651873,  6.871218], "C": [0,    374,   37.1,  -1.00,  -1.00,  -1.00], "D": [0,        174,      3.48,  -1.00,  -1.00,  -1.00]},
    {"Name": "Sr", "ZoA": 0.4336, "A": [0.7698690,  5.594200,  6.178207,  6.392259], "C": [0,    406,   40.5,  -1.00,  -1.00,  -1.00], "D": [0,        200,      4.14,  -1.00,  -1.00,  -1.00]},
    {"Name":  "Y", "ZoA": 0.4386, "A": [0.7276760,  5.225891,  5.751996,  5.960782], "C": [0,    441,   44.1,  -1.00,  -1.00,  -1.00], "D": [0,        229,      4.88,  -1.00,  -1.00,  -1.00]},
    {"Name": "Zr", "ZoA": 0.4385, "A": [0.6888930,  4.897467,  5.374963,  5.579097], "C": [0,    477,   47.9,  -1.00,  -1.00,  -1.00], "D": [0,        261,      5.72,  -1.00,  -1.00,  -1.00]},
    {"Name": "Nb", "ZoA": 0.4413, "A": [0.6530440,  4.595925,  5.030400,  5.230300], "C": [0,    515,   51.9,  -1.00,  -1.00,  -1.00], "D": [0,        296,      6.67,  -1.00,  -1.00,  -1.00]},
    {"Name": "Mo", "ZoA": 0.4377, "A": [0.6199370,  4.326793,  4.723030,  4.919620], "C": [0,    555,   56.2,  -1.00,  -1.00,  -1.00], "D": [0,        336,      7.73,  -1.00,  -1.00,  -1.00]},
    {"Name": "Tc", "ZoA": 0.4343, "A": [0.5891670,  4.075079,  4.438789,  4.631636], "C": [0,    597,   60.7,  -1.00,  -1.00,  -1.00], "D": [0,        379,      8.91,  -1.00,  -1.00,  -1.00]},
    {"Name": "Ru", "ZoA": 0.4352, "A": [0.5605780,  3.845666,  4.178916,  4.368874], "C": [0,    641,   65.5,  -1.00,  -1.00,  -1.00], "D": [0,        427,      10.1,  -1.00,  -1.00,  -1.00]},
    {"Name": "Rh", "ZoA": 0.4373, "A": [0.5339570,  3.633877,  3.940888,  4.127581], "C": [0,    686,   70.5,  -1.00,  -1.00,  -1.00], "D": [0,        479,       111,  -1.00,  -1.00,  -1.00]},
    {"Name": "Pd", "ZoA": 0.4323, "A": [0.5091690,  3.439899,  3.722916,  3.907108], "C": [0,    734,   75.8,  -1.00,  -1.00,  -1.00], "D": [0,        537,      12.8,  -1.00,  -1.00,  -1.00]},
    {"Name": "Ag", "ZoA": 0.4357, "A": [0.4859460,  3.257771,  3.518582,  3.699808], "C": [0,    784,   81.4,   56.7,   56.6,   9.94], "D": [0,        599,      14.3,   6.15,   8.76,  0.711]},
    {"Name": "Cd", "ZoA": 0.4270, "A": [0.4641660,  3.085721,  3.326651,  3.504856], "C": [0,    835,   87.4,   55.7,   44.5,   11.4], "D": [0,        667,      15.9,   5.42,   5.14,  0.990]},
    {"Name": "In", "ZoA": 0.4268, "A": [0.4437530,  2.925882,  3.148407,  3.323886], "C": [0,    889,   93.6,   54.0,   30.7,   12.0], "D": [0,        741,      17.7,   4.06,  0.327,   1.01]},
    {"Name": "Sn", "ZoA": 0.4212, "A": [0.4246020,  2.795776,  2.983188,  3.155779], "C": [0,    944,    100,   54.6,   27.5,   13.4], "D": [0,        821,      19.7,   3.50,  -1.39,   1.28]},
    {"Name": "Sb", "ZoA": 0.4189, "A": [0.4066230,  2.638918,  2.830432,  3.000442], "C": [0,   1000,    107,   58.0,   28.6,   15.1], "D": [0,        908,      21.8,   3.76,  -1.90,   1.64]},
    {"Name": "Te", "ZoA": 0.4075, "A": [0.3897190,  2.510209,  2.688297,  2.855859], "C": [0,   1060,    114,   60.0,   31.2,   14.9], "D": [0,       1000,      24.3,   3.83,  -1.66,   1.42]},
    {"Name":  "I", "ZoA": 0.4176, "A": [0.3737910,  2.389828,  2.555270,  2.720683], "C": [0,   1120,    122,   66.2,   35.9,   12.4], "D": [0,       1100,      27.1,   4.45,  -1.33,  0.760]},
    {"Name": "Xe", "ZoA": 0.4113, "A": [0.3587360,  2.273772,  2.429302,  2.592620], "C": [0,   1180,    130,   70.1,   39.3,   14.7], "D": [0,       1210,      30.2,   4.97, -0.964,   1.06]},
    {"Name": "Cs", "ZoA": 0.4138, "A": [0.3445480,  2.169719,  2.313398,  2.473798], "C": [0,   1250,    139,   74.6,   43.3,   17.0], "D": [0,       1330,      33.6,   5.02, -0.827,   1.38]},
    {"Name": "Ba", "ZoA": 0.4077, "A": [0.3311490,  2.070269,  2.204713,  2.362955], "C": [0,   1310,    147,   79.0,   46.8,   19.2], "D": [0,       1460,      37.3,   5.68, -0.468,   1.72]},
    {"Name": "La", "ZoA": 0.4103, "A": [0.3185240,  1.978588,  2.104782,  2.261372], "C": [0,   1380,    157,   92.8,   63.8,   21.5], "D": [0,       1590,      41.3,   10.4,   5.86,   2.07]},
    {"Name": "Ce", "ZoA": 0.4139, "A": [0.3065650,  1.893236,  2.011360,  2.166269], "C": [0,   1450,    166,    101,   56.6,   23.8], "D": [0,       1740,      45.6,   12.2,  0.564,   2.44]},
    {"Name": "Pr", "ZoA": 0.4187, "A": [0.2952670,  1.814015,  1.925102,  2.078773], "C": [0,   1420,    176,    107,   61.2,   26.1], "D": [0,       1580,      50.2,   12.6,  0.702,   2.83]},
    {"Name": "Nd", "ZoA": 0.4159, "A": [0.2845710,  1.739886,  1.844592,  1.997201], "C": [0,   1500,    187,    103,   67.5,   28.4], "D": [0,       1770,      55.1,   8.05,   2.32,   3.24]},
    {"Name": "Pm", "ZoA": 0.4207, "A": [0.2743990,  1.669170,  1.767971,  1.919469], "C": [0,   1600,    198,    109,   74.4,   30.7], "D": [0,       1940,      60.3,   8.22,   3.58,   3.67]},
    {"Name": "Sm", "ZoA": 0.4124, "A": [0.2647300,  1.602526,  1.695674,  1.846048], "C": [0,   1660,    210,    113,   73.8,   33.1], "D": [0,       2100,      65.8,   8.62,   1.75,   4.12]},
    {"Name": "Eu", "ZoA": 0.4145, "A": [0.2555380,  1.539795,  1.627710,  1.777068], "C": [0,   1760,    222,    122,   78.2,   35.4], "D": [0,       2300,      71.6,   10.3,   1.62,   4.61]},
    {"Name": "Gd", "ZoA": 0.4070, "A": [0.2467880,  1.480303,  1.563425,  1.711828], "C": [0,   1820,    234,    142,   83.5,   37.8], "D": [0,       2480,      77.7,   21.1,   3.13,   5.11]},
    {"Name": "Tb", "ZoA": 0.4090, "A": [0.2384510,  1.423797,  1.502548,  1.650043], "C": [0,   1930,    247,    135,   88.7,   40.3], "D": [0,       2740,      84.1,   11.9,   3.35,   5.64]},
    {"Name": "Dy", "ZoA": 0.4061, "A": [0.2305030,  1.370628,  1.444937,  1.591562], "C": [0,   2010,    261,    140,   94.0,   42.8], "D": [0,       2940,      90.8,   12.4,   4.22,   6.20]},
    {"Name": "Ho", "ZoA": 0.4062, "A": [0.2229220,  1.319796,  1.390301,  1.536151], "C": [0,   2110,    275,    142,   99.5,   45.4], "D": [0,       3200,      98.0,   9.00,   4.75,   6.79]},
    {"Name": "Er", "ZoA": 0.4065, "A": [0.2156790,  1.271464,  1.338301,  1.483438], "C": [0,   2210,    290,    151,    108,   48.0], "D": [0,       3460,       105,   10.2,   6.93,   7.41]},
    {"Name": "Tm", "ZoA": 0.4084, "A": [0.2087640,  1.225662,  1.289233,  1.433676], "C": [0,   2340,    305,    160,    115,   50.7], "D": [0,       3840,       113,   11.5,   8.73,   8.06]},
    {"Name": "Yb", "ZoA": 0.4045, "A": [0.2021520,  1.182334,  1.242551,  1.386290], "C": [0,   2430,    321,    168,    117,   53.4], "D": [0,       4100,       121,   13.0,   6.78,   8.75]},
    {"Name": "Lu", "ZoA": 0.4057, "A": [0.1958250,  1.140568,  1.198078,  1.341226], "C": [0,   2570,    337,    176,    123,   56.2], "D": [0,       4520,       130,   12.5,   6.46,   9.47]},
    {"Name": "Hf", "ZoA": 0.4034, "A": [0.1897210,  1.100058,  1.154480,  1.296812], "C": [0,   2670,    354,    183,    130,   59.2], "D": [0,       4830,       140,   12.2,   8.23,   10.2]},
    {"Name": "Ta", "ZoA": 0.4034, "A": [0.1839080,  1.061373,  1.113354,  1.254762], "C": [0,   2790,    372,    232,    137,   62.2], "D": [0,       5210,       150,   50.0,   9.42,   11.0]},
    {"Name":  "W", "ZoA": 0.4025, "A": [0.1783300,  1.024680,  1.074015,  1.214722], "C": [0,   2910,    390,    239,    145,   65.3], "D": [0,       5590,       161,   50.3,   11.4,   11.9]},
    {"Name": "Re", "ZoA": 0.4027, "A": [0.1729780, 0.9897600,  1.036770,  1.176846], "C": [0,   3030,    409,    255,    177,   68.4], "D": [0,       5990,       173,   58.3,   35.8,   12.7]},
    {"Name": "Os", "ZoA": 0.3996, "A": [0.1678390, 0.9560790,  1.001084,  1.140515], "C": [0,   3140,    429,    265,    185,   71.8], "D": [0,       6400,       187,   62.0,   38.9,   13.6]},
    {"Name": "Ir", "ZoA": 0.4006, "A": [0.1628990, 0.9239800, 0.9668070,  1.105502], "C": [0,   3320,    449,    282,    194,   75.2], "D": [0,       7070,       202,   70.4,   42.0,   14.6]},
    {"Name": "Pt", "ZoA": 0.3998, "A": [0.1581540, 0.8932650, 0.9341370,  1.072185], "C": [0,   3510,    470,    289,    202,   78.7], "D": [0,       7990,       219,   69.4,   44.4,   15.6]},
    {"Name": "Au", "ZoA": 0.4010, "A": [0.1535890, 0.8638330, 0.9027810,  1.040250], "C": [0,   3610,    492,    307,    211,   82.3], "D": [0,       8160,       240,   78.2,   46.3,   16.6]},
    {"Name": "Hg", "ZoA": 0.3988, "A": [0.1491950, 0.8355130, 0.8725940,  1.009323], "C": [0,   3730,    514,    321,    220,   86.1], "D": [0,       8670,       265,   85.7,   49.9,   17.7]},
    {"Name": "Tl", "ZoA": 0.3963, "A": [0.1449590, 0.8078890, 0.8435510, 0.9795320], "C": [0,   3880,    540,    341,    231,   90.0], "D": [0,       9360,       295,   99.2,   55.8,   18.9]},
    {"Name": "Pb", "ZoA": 0.3957, "A": [0.1408840, 0.7817020, 0.8156860, 0.9511500], "C": [0,   4030,    570,    353,    242,   94.1], "D": [0,       9970,       333,    102,   61.4,   20.0]},
    {"Name": "Bi", "ZoA": 0.3971, "A": [0.1369600, 0.7565780, 0.7891510, 0.9239730], "C": [0,   4230,    605,    375,    253,   98.3], "D": [0,      10800,       382,    117,   65.1,   21.3]}
];

function calcNSigmaKN(L) {
    if (L >= 2.5) return 0.396;
    var C = [2.56471267e-01, 5.29419953e-01, -1.01637025e+00, 1.11480447e+00, -7.21266885e-01, 2.72401661e-01, -5.55576150e-02, 4.72787421e-03];
    var A = C[7]*L + C[6];
    for (var i = 5 ; i >= 0 ; i--) A = A*L + C[i];
    return A;
}

function getElementNamesZ() {
    var arr = [];
    var Z = 0;
    elements.forEach(function(element){
        arr.push({"Z": Z, "Name": element.Name});
        Z++;
    });
    return arr;
}

function getLambdaOfEdge(Z, typeEdge) {
    return elements[Z].A[typeEdge];
}

function getBothMoR(Z, typeEdge) {
    var E = elements[Z];
    var L = E.A[typeEdge];
    var NSigmaKN = calcNSigmaKN(L);
    var MoR_S = L*L*L*(E.C[typeEdge+1] - L*E.D[typeEdge+1]) + E.ZoA*NSigmaKN;
    var MoR_L = L*L*L*(E.C[typeEdge+2] - L*E.D[typeEdge+2]) + E.ZoA*NSigmaKN;
    return [MoR_S, MoR_L];
}

function getMoR(Z, L) {
    var E = elements[Z];
    var NSigmaKN = calcNSigmaKN(L);
    var i = 0;
    if (L <= E.A[0]) i = 1; // shorter than K-edge
    else if (L <= E.A[1]) i = 2; // shorter than L1-edge
    else if (L <= E.A[2]) i = 3; // shorter than L2-edge
    else if (L <= E.A[3]) i = 4; // shorter than L3-edge
    else i = 5; // longer than L3-edge
    return L*L*L*(E.C[i] - L*E.D[i]) + E.ZoA*NSigmaKN;
}
